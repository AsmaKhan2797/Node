  SELECT AA.TID , TO_CHAR(AA.TXN_DATE,'DD/MM/YYYY HH24:MI:SS') DATETIME,
  (CASE WHEN NVL(AA.Pay_Mode,'-') = '-' THEN NVL(AA.Remark,'') 
   ELSE 
   (CASE WHEN NVL(AA.Pay_Mode,'-') = 'BQR' 
         THEN 
  (CASE WHEN AA.statusFlag = 'dr' THEN 'BharatQR Payment' ELSE 
  (CASE WHEN AA.statusFlag = 'p'   THEN 'BharatQR Request initiated' ELSE 'BharatQR Failed' END) END) 
        ELSE 
  (CASE WHEN NVL(AA.Pay_Mode,'-') = 'CASH'  THEN 'Cash Paid' ELSE NVL(AA.Pay_Mode,'-')END)
         END)
  END) Remark,
  
  TO_CHAR(AA.Amount) Amount, AA.statusFlag, NVL(AA.Pay_Mode,'-') Pay_Mode, 
  aa.TRANSACTION_ID FROM (SELECT TID , PRODUCT_PURCHASE_DATE TXN_DATE,PRODUCT_NAME Remark,PRODUCT_AMOUNT Amount,'cr' statusFlag,
  '' Pay_Mode  ,'' TRANSACTION_ID FROM PL_PRODUCT_DETAILS WHERE CUSTOMER_MOB_NO='9898989898' AND TID ='70015118' UNION SELECT TID,
  PAYMENT_DATE TXN_DATE, Remark, PAYMENT_AMOUNT Amount, ( CASE WHEN UPPER(PAYMENT_STATUS) =
  'S' THEN 'dr' ELSE lower(PAYMENT_STATUS) END)
  statusFlag , PAY_TYPE Pay_Mode, TRANSACTION_ID FROM PL_PAYMENT_DETAILS WHERE CUSTOMER_NUMBER='9898989898' AND TID ='70015118' ) AA
  ORDER BY TXN_DATE DESC  ;   